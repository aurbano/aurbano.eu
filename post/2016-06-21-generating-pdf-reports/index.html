<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Generating Pixel Perfect PDF Reports</title><meta name=description content="A blog by Alejandro U. Alvarez on programming and humans"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=cf-2fa-verify content="521cbed24d30f26"><meta property="og:site_name" content="Alejandro U. Alvarez - Blog"><meta property="og:type" content="article"><meta property="og:title" content="Generating Pixel Perfect PDF Reports"><meta property="og:description" content='Have you been tasked with generating PDF reports? If you have tried using the typical tools (iText for Java, ReportLab in Python&mldr; ) you understand why it&rsquo;s bad.
Imagine having to build a PDF like this:
Rectangle pagesize = new Rectangle(216f, 720f);
Document document = new Document(pagesize, 36f, 72f, 108f, 180f);
// step 2
PdfWriter.getInstance(document, new FileOutputStream(RESULT));
// step 3
document.open();
// step 4
document.add(new Paragraph(
    "Hello World! Hello People! " +
    "Hello Sky! Hello Sun! Hello Moon! Hello Stars!"));
// step 5
document.close();
Now add images, charts&mldr; and get ready to quit your job and become a farmer.'><meta property="og:url" content="https://aurbano.eu/post/2016-06-21-generating-pdf-reports/"><meta property="article:published_time" content="2016-06-21 00:00:00 +0000 UTC"><meta property="article:modified_time" content="2016-06-21 00:00:00 +0000 UTC"><meta name=twitter:card content="summary"><meta name=twitter:title content="Generating Pixel Perfect PDF Reports"><meta name=twitter:description content='Have you been tasked with generating PDF reports? If you have tried using the typical tools (iText for Java, ReportLab in Python&mldr; ) you understand why it&rsquo;s bad.
Imagine having to build a PDF like this:
Rectangle pagesize = new Rectangle(216f, 720f);
Document document = new Document(pagesize, 36f, 72f, 108f, 180f);
// step 2
PdfWriter.getInstance(document, new FileOutputStream(RESULT));
// step 3
document.open();
// step 4
document.add(new Paragraph(
    "Hello World! Hello People! " +
    "Hello Sky! Hello Sun! Hello Moon! Hello Stars!"));
// step 5
document.close();
Now add images, charts&mldr; and get ready to quit your job and become a farmer.'><meta name=twitter:url content="https://aurbano.eu/post/2016-06-21-generating-pdf-reports/"><meta name=twitter:label1 content="Written by"><meta name=twitter:data1 content="Alejandro U. Alvarez"><script async src="https://www.googletagmanager.com/gtag/js?id=G-BYFMFK4EX1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BYFMFK4EX1")</script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dark.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/css/main.min.2ae91b201b00604bbc7d8b4b6c640ad92f3c3d0b5cccfe88b94d7957e2e0e1ab.css><script src=https://code.jquery.com/jquery-3.4.1.slim.min.js integrity=sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n crossorigin=anonymous></script></head><body class="flex flex-col min-h-screen"><nav class="transition-all duration-300 bg-magazine-white/80 backdrop-blur-md border-b border-magazine-black/5 sticky top-0 z-50 shadow-sm"><div class="container mx-auto px-8 py-6 max-w-7xl"><div class="flex items-center justify-between lg:hidden"><a class="nav-link relative font-medium py-2 px-3 hover:text-magazine-accent transition-colors duration-200 text-xl font-black text-magazine-accent hover:text-magazine-accent-dark" href=/>Alejandro U. Alvarez
</a><button id=navToggle class="p-3 text-magazine-black hover:text-magazine-accent transition-colors" type=button aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<i class="fa-solid fa-bars text-xl"></i></button></div><div class="navbar-collapse hidden lg:flex items-center justify-between w-full" id=navbarSupportedContent><ul class="flex items-center gap-2"><li class="hidden lg:block"><a class="nav-link relative font-medium py-2 px-3 hover:text-magazine-accent transition-colors duration-200 text-xl font-black text-magazine-accent hover:text-magazine-accent-dark" href=/>Alejandro U. Alvarez</a></li><li class="hidden lg:block"><span class="text-magazine-black/20 mx-2">·</span></li><li><a class="nav-link relative font-medium py-2 px-3 hover:text-magazine-accent transition-colors duration-200 text-base" href=/>Home</a></li><li><a class="nav-link relative font-medium py-2 px-3 hover:text-magazine-accent transition-colors duration-200 text-base" href=/about/>About</a></li><li><a class="nav-link relative font-medium py-2 px-3 hover:text-magazine-accent transition-colors duration-200 text-base" href=/photography/>Photography</a></li><li><a class="nav-link relative font-medium py-2 px-3 hover:text-magazine-accent transition-colors duration-200 text-base" href=/post/>All posts</a></li></ul><ul class="flex items-center gap-3"><li><a title=github class="inline-flex items-center justify-center w-10 h-10 rounded-full hover:bg-magazine-accent/10 transition-all duration-200 text-magazine-accent hover:text-magazine-accent-dark text-lg" href=https://github.com/aurbano/ target=_blank rel=noopener><i class="fa-brands fa-github"></i></a></li><li><a title=linkedin class="inline-flex items-center justify-center w-10 h-10 rounded-full hover:bg-magazine-accent/10 transition-all duration-200 text-magazine-accent hover:text-magazine-accent-dark text-lg" href=https://www.linkedin.com/in/aurbano/ target=_blank rel=noopener><i class="fa-brands fa-linkedin"></i></a></li><li><a title=twitter class="inline-flex items-center justify-center w-10 h-10 rounded-full hover:bg-magazine-accent/10 transition-all duration-200 text-magazine-accent hover:text-magazine-accent-dark text-lg" href=https://twitter.com/alalex target=_blank rel=noopener><i class="fa-brands fa-twitter"></i></a></li><li><a title=stack-overflow class="inline-flex items-center justify-center w-10 h-10 rounded-full hover:bg-magazine-accent/10 transition-all duration-200 text-magazine-accent hover:text-magazine-accent-dark text-lg" href=https://stackoverflow.com/users/1262824/aurbano target=_blank rel=noopener><i class="fa-brands fa-stack-overflow"></i></a></li><li><a title=hacker-news class="inline-flex items-center justify-center w-10 h-10 rounded-full hover:bg-magazine-accent/10 transition-all duration-200 text-magazine-accent hover:text-magazine-accent-dark text-lg" href="https://news.ycombinator.com/user?id=aurbano" target=_blank rel=noopener><i class="fa-brands fa-hacker-news"></i></a></li><li><a title=rss class="inline-flex items-center justify-center w-10 h-10 rounded-full hover:bg-magazine-accent/10 transition-all duration-200 text-magazine-accent hover:text-magazine-accent-dark text-lg" href=/index.xml target=_blank rel=noopener><i class="fa-solid fa-rss"></i></a></li></ul></div></div></nav><script>(function(){const e=document.getElementById("navToggle"),t=document.getElementById("navbarSupportedContent");e&&t&&e.addEventListener("click",function(){const e=this.getAttribute("aria-expanded")==="true";t.classList.toggle("hidden"),this.setAttribute("aria-expanded",!e)})})()</script><div class=accent-line></div><main class="flex-1 py-16"><div class="container mx-auto px-8 max-w-4xl"><article><header class=mb-16><div class="text-sm mb-6"><a href=/ class="text-magazine-accent hover:underline">Home</a>
<span class=mx-2>→</span>
<a href=/post class="text-magazine-accent hover:underline">Posts</a></div><h1 class="text-5xl md:text-7xl font-black mb-6 leading-none tracking-tight">Generating Pixel Perfect PDF Reports</h1><div class="flex flex-wrap items-center justify-between gap-4 pb-6 border-b-2 border-magazine-black/10"><div class="flex items-center gap-4"><time class="inline-block px-4 py-2 bg-magazine-accent text-magazine-white font-bold rounded-full text-sm">June 21, 2016
</time><span class=text-magazine-black/60>4 min read</span></div><a href=https://github.com/aurbano/aurbano.eu/blob/master/content/post/2016-06-21-generating-pdf-reports.md class="text-magazine-black/60 hover:text-magazine-accent transition-colors" title="Edit on GitHub"><i class="fa-solid fa-pencil"></i> Edit</a></div><div class="mt-4 flex flex-wrap gap-2"><a href=https://aurbano.eu//tags/PDF class=tag>PDF
</a><a href=https://aurbano.eu//tags/Java class=tag>Java</a></div></header><div class="content prose prose-lg max-w-none"><p>Have you been tasked with generating PDF reports? If you have tried using the typical tools (iText for Java, ReportLab in Python&mldr; ) you understand why it&rsquo;s bad.</p><p>Imagine having to build a PDF like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Rectangle pagesize <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Rectangle(216f, 720f);
</span></span><span style=display:flex><span>Document document <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Document(pagesize, 36f, 72f, 108f, 180f);
</span></span><span style=display:flex><span><span style=color:#75715e>// step 2</span>
</span></span><span style=display:flex><span>PdfWriter.<span style=color:#a6e22e>getInstance</span>(document, <span style=color:#66d9ef>new</span> FileOutputStream(RESULT));
</span></span><span style=display:flex><span><span style=color:#75715e>// step 3</span>
</span></span><span style=display:flex><span>document.<span style=color:#a6e22e>open</span>();
</span></span><span style=display:flex><span><span style=color:#75715e>// step 4</span>
</span></span><span style=display:flex><span>document.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> Paragraph(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Hello World! Hello People! &#34;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Hello Sky! Hello Sun! Hello Moon! Hello Stars!&#34;</span>));
</span></span><span style=display:flex><span><span style=color:#75715e>// step 5</span>
</span></span><span style=display:flex><span>document.<span style=color:#a6e22e>close</span>();
</span></span></code></pre></div><p>Now add images, charts&mldr; and get ready to quit your job and become a farmer.</p><p>HTML/CSS can have many downsides, but the reality is that they are one of the easiest ways to <em>programatically generate</em> a document with any design we could think of.</p><p>So I thought that if I wanted our reports to follow the branding of our web application, we should be <strong>rendering HTML/CSS</strong> to a <strong>PDF</strong>.</p><p>This will even allow you to generate the PDF reports using your existing code, be it Angular/React&mldr; etc.</p><h2 id=enter-phantomjs>Enter PhantomJS</h2><p><strong>Quick intro:</strong> PhantomJS is a <em>&ldquo;headless&rdquo;</em> browser, that can render a web page just like Chrome, from the command line. And it can output the website as an image or pdf.</p><p><strong>Benefits:</strong> You can actually run this from Java, NodeJS, Python, or whichever language that allows you to call an executable. In fact from NodeJS it would be even easier since PhantomJS runs in Node.</p><p>Since I did this for a reporting system at work, that was built in Java, I&rsquo;ll focus on that.</p><p>You&rsquo;ll need three things to generate a report:</p><ol><li>PhantomJS executable</li><li>JavaScript config file for PhantomJS</li><li>HTML file to convert into PDF</li></ol><h3 id=javascript-config-file-for-phantomjs>JavaScript config file for PhantomJS</h3><p>The following file will configure PhantomJS to generate a standard A4 PDF, in portrait mode.</p><p>It will take the HTML content and the PDF output file from the CLI arguments.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>page</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;webpage&#39;</span>).<span style=color:#a6e22e>create</span>(),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>system</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;system&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;fs&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>settings</span>.<span style=color:#a6e22e>userAgent</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;aurbano&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// The following are only required if you&#39;re loading assets using file://
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>settings</span>.<span style=color:#a6e22e>localToRemoteUrlAccessEnabled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>settings</span>.<span style=color:#a6e22e>webSecurityEnabled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>settings</span>.<span style=color:#a6e22e>loadImages</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>paperSize</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>format</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;A4&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>orientation</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;portrait&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>margin</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;1.5cm&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;1cm&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>footer</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;1cm&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>contents</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>phantom</span>.<span style=color:#a6e22e>callback</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>pageNum</span>, <span style=color:#a6e22e>numPages</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;&lt;div style=&#34;margin: 0 1cm 0 1cm; font-size: 0.65em&#34;&gt;&#39;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;   &lt;div style=&#34;color: #888; padding:20px 20px 0 10px; border-top: 1px solid #ccc;&#34;&gt;&#39;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;       &lt;span&gt;REPORT FOOTER&lt;/span&gt; &#39;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;       &lt;span style=&#34;float:right&#34;&gt;&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>pageNum</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39; / &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>numPages</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&lt;/span&gt;&#39;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;   &lt;/div&gt;&#39;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;&lt;/div&gt;&#39;</span>;
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// This will fix some things that I&#39;ll talk about in a second
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>settings</span>.<span style=color:#a6e22e>dpi</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;96&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>content</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>read</span>(<span style=color:#a6e22e>system</span>.<span style=color:#a6e22e>args</span>[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>output</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>system</span>.<span style=color:#a6e22e>args</span>[<span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>window.<span style=color:#a6e22e>setTimeout</span>(<span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>render</span>(<span style=color:#a6e22e>output</span>, {<span style=color:#a6e22e>format</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;pdf&#39;</span>});
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>phantom</span>.<span style=color:#a6e22e>exit</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>}, <span style=color:#ae81ff>2000</span>);
</span></span></code></pre></div><h3 id=html-file>HTML File</h3><p>Any file, with any contents will work just fine. To load local resources you can just use the <code>file://</code> protocol.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>title</span>&gt;The title is irrelevant&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>http-equiv</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;content-type&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/html; charset=UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>link</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> <span style=color:#a6e22e>media</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;all&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/css&#34;</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file:///path/to/stylesheet.css&#34;</span> /&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>style</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/css&#34;</span> <span style=color:#a6e22e>media</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;all&#34;</span>&gt;
</span></span><span style=display:flex><span>        <span style=color:#f92672>html</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>margin</span>:<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            zoom: <span style=color:#ae81ff>1</span>; <span style=color:#75715e>/* or 0.76 for Linux */</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>style</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>h1</span>&gt;Sample report&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>p</span>&gt;It works!&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><h2 id=executing>Executing</h2><p>If running this from the command line, just make sure you have NodeJS and PhantomJS installed (duh&mldr; ), then run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ phantomjs configFile.js htmlFile.html output.pdf
</span></span></code></pre></div><p>If you wanted to run this programatically from Java for example, you could use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// Get HTML Report</span>
</span></span><span style=display:flex><span>URL htmlFileUrl <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getResource</span>(<span style=color:#e6db74>&#34;htmlFile.html&#34;</span>);
</span></span><span style=display:flex><span>File htmlFile <span style=color:#f92672>=</span> Paths.<span style=color:#a6e22e>get</span>(htmlFileUrl.<span style=color:#a6e22e>toURI</span>()).<span style=color:#a6e22e>toFile</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Get JS config file</span>
</span></span><span style=display:flex><span>URL configFileUrl <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getResource</span>(<span style=color:#e6db74>&#34;configFile.js&#34;</span>);
</span></span><span style=display:flex><span>File configFile <span style=color:#f92672>=</span> Paths.<span style=color:#a6e22e>get</span>(configFileUrl.<span style=color:#a6e22e>toURI</span>()).<span style=color:#a6e22e>toFile</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// tmp pdf file for output</span>
</span></span><span style=display:flex><span>File pdfReport <span style=color:#f92672>=</span> File.<span style=color:#a6e22e>createTempFile</span>(<span style=color:#e6db74>&#34;report&#34;</span>, <span style=color:#e6db74>&#34;.pdf&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ProcessBuilder renderProcess <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ProcessBuilder(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;/path/to/phantomjs&#34;</span>,
</span></span><span style=display:flex><span>        configFile.<span style=color:#a6e22e>getAbsolutePath</span>(),
</span></span><span style=display:flex><span>        htmlFile.<span style=color:#a6e22e>getAbsolutePath</span>(),
</span></span><span style=display:flex><span>        pdfReport.<span style=color:#a6e22e>getAbsolutePath</span>()
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Process phantom <span style=color:#f92672>=</span> renderProcess.<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// you need to read phantom.getInputStream() and phantom.getErrorStream()</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// otherwise if they output something the process won&#39;t end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> exitCode <span style=color:#f92672>=</span> phantom.<span style=color:#a6e22e>waitFor</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(exitCode <span style=color:#f92672>!=</span> 0){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// report generation failed</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// success!</span>
</span></span></code></pre></div><p>The coolest thing? If you can render it in HTML, you can render it in your report!</p><p>This means that now you can almost directly copy/paste from your application, you can even use AngularJS/React to generate the content&mldr; The possibilities are endless.</p><h2 id=caveats>Caveats</h2><p>As of versions &lt;= 2.1 PhantomJS renders differenly on Windows and Linux. I believe this is caused by different DPI settings.</p><p>After <strong>hours</strong> of debugging and trying to figure out ways to fix it, I decided to use a CSS transform to adjust for the difference, you can find it commented in the HTML file. The magic number is <strong>0.76</strong>, if you find a better solution please let me know!</p></div></article></div></main><div class="h-1 bg-gradient-to-r from-magazine-accent via-magazine-accent-light to-magazine-secondary"></div><footer class="bg-magazine-accent text-magazine-white"><div class="container mx-auto px-8 max-w-7xl py-12"><div class=text-center><p class="mb-6 text-lg"><a href=/ class="font-black text-magazine-white hover:text-magazine-cream transition-colors text-2xl">Alejandro U. Alvarez</a></p><p class="mb-8 text-magazine-white/70">All rights reserved</p><div class="flex justify-center gap-4 text-sm flex-wrap mb-8"><a href=/index.xml class="hover:text-magazine-cream transition-colors font-medium">RSS</a>
<span class=text-magazine-accent-light>●</span>
<a href=/post class="hover:text-magazine-cream transition-colors font-medium">All posts</a>
<span class=text-magazine-accent-light>●</span>
<a href=/categories class="hover:text-magazine-cream transition-colors font-medium">Categories</a>
<span class=text-magazine-accent-light>●</span>
<a href=/tags class="hover:text-magazine-cream transition-colors font-medium">Tags</a></div><div class="flex justify-center gap-2 mb-6"><div class="w-12 h-px bg-magazine-accent-light"></div><div class="w-12 h-px bg-magazine-cream"></div><div class="w-12 h-px bg-magazine-secondary"></div></div><div class="flex justify-center gap-4"><a href=https://github.com/aurbano/ title=github class="w-10 h-10 flex items-center justify-center rounded-full bg-magazine-white/10 hover:bg-magazine-white hover:text-magazine-accent transition-all duration-300" target=_blank rel=noopener><i class="fa-brands fa-github"></i>
</a><a href=https://www.linkedin.com/in/aurbano/ title=linkedin class="w-10 h-10 flex items-center justify-center rounded-full bg-magazine-white/10 hover:bg-magazine-white hover:text-magazine-accent transition-all duration-300" target=_blank rel=noopener><i class="fa-brands fa-linkedin"></i>
</a><a href=https://twitter.com/alalex title=twitter class="w-10 h-10 flex items-center justify-center rounded-full bg-magazine-white/10 hover:bg-magazine-white hover:text-magazine-accent transition-all duration-300" target=_blank rel=noopener><i class="fa-brands fa-twitter"></i>
</a><a href=https://stackoverflow.com/users/1262824/aurbano title=stack-overflow class="w-10 h-10 flex items-center justify-center rounded-full bg-magazine-white/10 hover:bg-magazine-white hover:text-magazine-accent transition-all duration-300" target=_blank rel=noopener><i class="fa-brands fa-stack-overflow"></i>
</a><a href="https://news.ycombinator.com/user?id=aurbano" title=hacker-news class="w-10 h-10 flex items-center justify-center rounded-full bg-magazine-white/10 hover:bg-magazine-white hover:text-magazine-accent transition-all duration-300" target=_blank rel=noopener><i class="fa-brands fa-hacker-news"></i>
</a><a href=/index.xml title=rss class="w-10 h-10 flex items-center justify-center rounded-full bg-magazine-white/10 hover:bg-magazine-white hover:text-magazine-accent transition-all duration-300" target=_blank rel=noopener><i class="fa-solid fa-rss"></i></a></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js></script><script>hljs.initHighlightingOnLoad()</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script>document.addEventListener("DOMContentLoaded",function(){const t=document.querySelector(".navbar-toggler"),e=document.querySelector(".navbar-collapse");t&&e&&(t.addEventListener("click",function(){e.classList.toggle("show")}),document.addEventListener("click",function(n){!t.contains(n.target)&&!e.contains(n.target)&&e.classList.remove("show")}))})</script></body></html>