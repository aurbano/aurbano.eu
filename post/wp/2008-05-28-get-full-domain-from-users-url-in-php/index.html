<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Get full domain from user's URL in php</title><meta name=description content="A blog by Alejandro U. Alvarez on programming and humans"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta property="og:site_name" content="Alejandro U. Alvarez - Blog"><meta property="og:type" content="article"><meta property="og:title" content="Get full domain from user's URL in php"><meta property="og:description" content="What I'm going to post here is a php function that will create a standard url from a user-inputted url so that any string will be converted to a functioning url.
First it will convert all characters to lowercase:
$url = strtolower($url); Now add http:// if it is not at the beggining:
if(strncasecmp('http://',$url,7) !== 0){ //There is no http:// at the beginning: $url = 'http://'.$url; } What strncasecmp does is it takes a string, and then a number."><meta property="og:url" content="https://aurbano.eu/post/wp/2008-05-28-get-full-domain-from-users-url-in-php/"><meta property="article:published_time" content="2008-05-28 00:00:00 +0000 UTC"><meta property="article:modified_time" content="2008-05-28 00:00:00 +0000 UTC"><meta name=twitter:card content="summary"><meta name=twitter:title content="Get full domain from user's URL in php"><meta name=twitter:description content="What I'm going to post here is a php function that will create a standard url from a user-inputted url so that any string will be converted to a functioning url.
First it will convert all characters to lowercase:
$url = strtolower($url); Now add http:// if it is not at the beggining:
if(strncasecmp('http://',$url,7) !== 0){ //There is no http:// at the beginning: $url = 'http://'.$url; } What strncasecmp does is it takes a string, and then a number."><meta name=twitter:url content="https://aurbano.eu/post/wp/2008-05-28-get-full-domain-from-users-url-in-php/"><meta name=twitter:label1 content="Written by"><meta name=twitter:data1 content="Alejandro U. Alvarez"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dark.min.css><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link rel=stylesheet href=https://aurbano.eu/main.min.36c3f996bf4f30efa029bc7da3c19dfbb06b20f98638844a7094b96e7fe99ad3.css><script src=https://code.jquery.com/jquery-3.4.1.slim.min.js integrity=sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n crossorigin=anonymous></script></head><body><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class=container><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav nav-menu mr-auto"><li class=nav-item><a class=nav-link href=/>Home</a></li><li class=nav-item><a class=nav-link href=/about/>About</a></li><li class=nav-item><a class=nav-link href=/post/>Posts</a></li><li class=nav-item><a class=nav-link href=/projects/>Projects</a></li></ul><ul class=navbar-nav><li class=nav-item><a title="github profile" class="nav-link text-github" href=https://github.com/aurbano/><i class="fa fa-github"></i></a></li><li class=nav-item><a title="linkedin profile" class="nav-link text-linkedin" href=https://www.linkedin.com/in/aurbano/><i class="fa fa-linkedin"></i></a></li><li class=nav-item><a title="stack-overflow profile" class="nav-link text-stack-overflow" href=https://stackoverflow.com/users/1262824/aurbano><i class="fa fa-stack-overflow"></i></a></li><li class=nav-item><a title="hacker-news profile" class="nav-link text-hacker-news" href="https://news.ycombinator.com/user?id=aurbano"><i class="fa fa-hacker-news"></i></a></li><li class=nav-item><a title="rss profile" class="nav-link text-rss" href=/index.xml><i class="fa fa-rss"></i></a></li></ul></div></div></nav><main><div class=container><div class="row justify-content-md-center"><div class="col col-lg-8"><header><h1>Get full domain from user's URL in php</h1><div class=row><div class=col><small class="date text-muted">Published on May 28, 2008</small>
<a href=https://aurbano.eu/tags/PHP class=item-tag>PHP</a></div><div class="col-2 text-right"><a href=https://github.com/aurbano/aurbano.eu/blob/master/content/post/wp/2008-05-28-get-full-domain-from-users-url-in-php.md class=edit title="Open this post on Github"><i class="fa fa-pencil"></i></a></div></div></header><div class="alert alert-warning mt-4" role=alert><b>Here be dragons!</b><br>I wrote this ages ago and is now outdated. Time flies!</div><div align=start class=content><p>What I'm going to post here is a php function that will create a standard url from a user-inputted url so that any string will be converted to a functioning url.</p><p>First it will convert all characters to lowercase:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>$url = strtolower($url);
</code></pre></div><p>Now add http:// if it is not at the beggining:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>if(strncasecmp(&#39;http://&#39;,$url,7) !== 0){
	//There is no http:// at the beginning:
	$url = &#39;http://&#39;.$url;
}
</code></pre></div><p>What <code>strncasecmp</code> does is it takes a string, and then a number. It then checks to see if that string is contained within the first (That second parameter) characters contain it. It returns 0 if it is found.<br>So in the example it checks to see if http:// is there, and if it is not, it adds it.</p><p>Now strip all folders (This is optional, but here I will show how to make sure only the main domain is left</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>$parts = explode(&#39;/&#39;,$url);
if(sizeof($parts) !== 1){
	//no / in the string: (No http, no ending /)
	$url = $parts[2];
}
</code></pre></div><p>So now we've got something like "http://{user_input}/".<br>Let's make sure it has (or not) www. And if not, let's add it (Just for consistency)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>if(strncasecmp(&#39;www.&#39;,$url,4) !== 0){
	//There is no www.
	return &#39;http://www.&#39;.$url.&#39;/&#39;;
}else{
	return &#39;http://&#39;.$url.&#39;/&#39;;
}
</code></pre></div><p>Now we have "http://www.{user input}/" , we are basically done!<br>If you really want to this this correctly you could check if the URL exists, but this is just a waste of bandwidth and opens a door for attacks from my point of view&mldr;<br>So if you want to do this, create the following function:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>function url_exists($strURL) {
    $resURL = curl_init();
    curl_setopt($resURL, CURLOPT_URL, $strURL);
    curl_setopt($resURL, CURLOPT_BINARYTRANSFER, 1);
    curl_setopt($resURL, CURLOPT_HEADERFUNCTION, &#39;curlHeaderCallback&#39;);
    curl_setopt($resURL, CURLOPT_FAILONERROR, 1);

    curl_exec ($resURL);

    $intReturnCode = curl_getinfo($resURL, CURLINFO_HTTP_CODE);
    curl_close ($resURL);

    if ($intReturnCode != 200 <span style=color:#960050;background-color:#1e0010>&amp;</span><span style=color:#960050;background-color:#1e0010>&amp;</span> $intReturnCode != 302 <span style=color:#960050;background-color:#1e0010>&amp;</span><span style=color:#960050;background-color:#1e0010>&amp;</span> $intReturnCode != 304) {
       return false;
    }Else{
        return true ;
    }
} 
</code></pre></div><p>And call it from our previous script:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>if(url_exists($url)) {
     return true;
}else{
    return false;
}
</code></pre></div><h3 id=full-code-now>Full code now:</h3><p>So the whole thing would be something like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>//Function to make main domain from url:
function url_exists($strURL) {
    $resURL = curl_init();
    curl_setopt($resURL, CURLOPT_URL, $strURL);
    curl_setopt($resURL, CURLOPT_BINARYTRANSFER, 1);
    curl_setopt($resURL, CURLOPT_HEADERFUNCTION, &#39;curlHeaderCallback&#39;);
    curl_setopt($resURL, CURLOPT_FAILONERROR, 1);

    curl_exec ($resURL);

    $intReturnCode = curl_getinfo($resURL, CURLINFO_HTTP_CODE);
    curl_close ($resURL);

    if ($intReturnCode != 200 <span style=color:#960050;background-color:#1e0010>&amp;</span><span style=color:#960050;background-color:#1e0010>&amp;</span> $intReturnCode != 302 <span style=color:#960050;background-color:#1e0010>&amp;</span><span style=color:#960050;background-color:#1e0010>&amp;</span> $intReturnCode != 304) {
       return false;
    }Else{
        return true ;
    }
} 
//And now the function
function domain($url,$checkIfExists=0){
	//This function creates a url in the form http://www.domain.com/
	$url = strtolower($url);
	if(strncasecmp(&#39;http://&#39;,$url,7) !== 0){
		//There is no http:// at the beginning:
		$url = &#39;http://&#39;.$url;
	}
	$parts = explode(&#39;/&#39;,$url);
	if(sizeof($parts) !== 1){
		//no / in the string: (No http, no ending /)
		$url = $parts[2];
	}
	//Now check if the url has or not www. in it:
	if(strncasecmp(&#39;www.&#39;,$url,4) !== 0){
		//There is no www.
		return &#39;http://www.&#39;.$url.&#39;/&#39;;
	}else{
		return &#39;http://&#39;.$url.&#39;/&#39;;
	}
	if($checkIfExists !== 0){
		//User wanted to check if exists:
		If(url_exists($url)) {
			return $url;
		}else{
			return false;
		}
	}
}
</code></pre></div></div><div class="card mt-4 shadow"><div class=card-body><h5 class=card-title>More like this:</h5><div class=item><h6><a href=/post/wp/2009-01-20-display-time-since-last-visit-in-php/>Display time since last visit in PHP</a>
<small class="date text-muted">January 20, 2009</small></h6></div><div class=item><h6><a href=/post/wp/2008-09-11-assign-image-to-wordpress-post/>Easily assign an image to a post in WordPress</a>
<small class="date text-muted">September 11, 2008</small></h6></div><div class=item><h6><a href=/post/wp/2008-05-30-did-you-mean-in-php/>Did you mean? In php</a>
<small class="date text-muted">May 30, 2008</small></h6></div></div></div></div></div></div></main><footer><p class="copyright text-muted"><a href=/>Alejandro U. Alvarez</a>
Â© All rights reserved.
&bull;
<a href=/index.xml>RSS</a>
&bull;
<a href=/categories>Categories</a>
&bull;
<a href=/tags>Tags</a></p></footer><div class="border animated-hue"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js></script><script>hljs.initHighlightingOnLoad();</script><script src=https://aurbano.eu/vendor/bootstrap/dist/js/bootstrap.bundle.min.js></script><script>$(document).on('click',function(){$('.collapse').collapse('hide');})</script></body></html>