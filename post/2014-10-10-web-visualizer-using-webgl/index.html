<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Web Visualizer using WebGL</title><meta name=description content="A blog by Alejandro U. Alvarez on programming and humans"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta property="og:site_name" content="Alejandro U. Alvarez - Blog"><meta property="og:type" content="article"><meta property="og:title" content="Web Visualizer using WebGL"><meta property="og:description" content="I decided to build a tool that would allow me to see how websites are related in a visual way. I&rsquo;m still working on the concept but the tool is ready and working: WebVisualizer.
Building blocks In order to get this to work there were some basic building blocks I needed. Some server side and a few client side. Here is a little run through:
Client graph rendering I had some experience with the VivaGraph library, from the very talented Andrei Kashcha, so that was an obvious choice."><meta property="og:url" content="https://aurbano.eu/post/2014-10-10-web-visualizer-using-webgl/"><meta property="article:published_time" content="2014-10-10 00:00:00 +0000 UTC"><meta property="article:modified_time" content="2014-10-10 00:00:00 +0000 UTC"><meta name=twitter:card content="summary"><meta name=twitter:title content="Web Visualizer using WebGL"><meta name=twitter:description content="I decided to build a tool that would allow me to see how websites are related in a visual way. I&rsquo;m still working on the concept but the tool is ready and working: WebVisualizer.
Building blocks In order to get this to work there were some basic building blocks I needed. Some server side and a few client side. Here is a little run through:
Client graph rendering I had some experience with the VivaGraph library, from the very talented Andrei Kashcha, so that was an obvious choice."><meta name=twitter:url content="https://aurbano.eu/post/2014-10-10-web-visualizer-using-webgl/"><meta name=twitter:label1 content="Written by"><meta name=twitter:data1 content="Alejandro U. Alvarez"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dark.min.css><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link rel=stylesheet href=https://aurbano.eu/main.min.96f9876ce256fc4617bd1a3c093c2b7c2b898e5349b30f523f738cb7b4ade08a.css><script src=https://code.jquery.com/jquery-3.4.1.slim.min.js integrity=sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n crossorigin=anonymous></script></head><body><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class=container><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav nav-menu mr-auto"><li class=nav-item><a class=nav-link href=/ style=font-weight:700>Alejandro U. Alvarez</a></li><li class=nav-item><a class=nav-link href=/about/>About</a></li><li class=nav-item><a class=nav-link href=/post/>Posts</a></li><li class=nav-item><a class=nav-link href=/projects/>Projects</a></li></ul><ul class=navbar-nav><li class=nav-item><a title="github profile" class="nav-link text-github" href=https://github.com/aurbano/><i class="fa fa-github"></i></a></li><li class=nav-item><a title="linkedin profile" class="nav-link text-linkedin" href=https://www.linkedin.com/in/aurbano/><i class="fa fa-linkedin"></i></a></li><li class=nav-item><a title="stack-overflow profile" class="nav-link text-stack-overflow" href=https://stackoverflow.com/users/1262824/aurbano><i class="fa fa-stack-overflow"></i></a></li><li class=nav-item><a title="hacker-news profile" class="nav-link text-hacker-news" href="https://news.ycombinator.com/user?id=aurbano"><i class="fa fa-hacker-news"></i></a></li><li class=nav-item><a title="rss profile" class="nav-link text-rss" href=/index.xml><i class="fa fa-rss"></i></a></li></ul></div></div></nav><main><div class=container><div class="row justify-content-md-center"><div class="col col-lg-8"><header><h1>Web Visualizer using WebGL</h1><div class=row><div class=col><small class="date text-muted">Published on October 10, 2014</small>
<a href=https://aurbano.eu/tags/JavaScript class=item-tag>JavaScript</a>
<a href=https://aurbano.eu/tags/WebGL class=item-tag>WebGL</a>
<a href=https://aurbano.eu/tags/Graphs class=item-tag>Graphs</a></div><div class="col-2 text-right"><a href=https://github.com/aurbano/aurbano.eu/blob/master/content/post/2014-10-10-web-visualizer-using-webgl.md class=edit title="Open this post on Github"><i class="fa fa-pencil"></i></a></div></div></header><div align=start class=content><p>I decided to build a tool that would allow me to see how websites are related in a visual way. I&rsquo;m still working on the concept but the tool is ready and working: <a href=http://web-visualizer.urbanoalvarez.es>WebVisualizer</a>.</p><h2 id=building-blocks>Building blocks</h2><p>In order to get this to work there were some basic building blocks I needed. Some server side and a few client side. Here is a little run through:</p><h3 id=client-graph-rendering>Client graph rendering</h3><p>I had some experience with the <a href=https://github.com/anvaka/VivaGraphJS>VivaGraph</a> library, from the very talented <a href=http://www.yasiv.com/>Andrei Kashcha</a>, so that was an obvious choice. It allows you to render very large graphs (tested up to 50000+) using WebGL without any hassle really.</p><p>Using WebGL has some limitations, the main one is that it can <strong>only access same domain assets</strong> (Unless using CORS or changing the accept headers). This means we&rsquo;ll need a server proxy to load the favicons for each website.</p><h3 id=server>Server</h3><p>I needed to setup a server, both for the image proxy and to interact with the Search APIs (they all require private keys) so I decided to go with <strong>Nodejs</strong> and deploy to Heroku through Travis.</p><p>For the tests I&rsquo;m using <a href=https://www.npmjs.org/package/mocha>mocha</a> with <a href=https://www.npmjs.org/package/should>should</a> and <a href=https://www.npmjs.org/package/supertest>supertest</a>, they make testing a web server extremely easy.</p><p>Testing the Image proxy (detailed below):</p><script type=application/javascript src="https://gist.github.com/aurbano/3d8829c5cdb243f3fded.js?file=proxyTest.js"></script><h3 id=image-proxy>Image proxy</h3><p>There were some existing npm packages to proxy requests in Nodejs, but I wanted something very simple. I set it up using Express and require:</p><script type=application/javascript src="https://gist.github.com/aurbano/3d8829c5cdb243f3fded.js?file=expressProxy.js"></script><h3 id=search-api>Search API</h3><p>I was going to use the usual Google Search API, but it turns out it was deprecated some years ago and will be dissapearing. They are replacing it with the Custom Search API, which unfortunately only allows 100 queries/day.</p><p>After searching around for a bit I found that Bing offered 5000 queries/month, 5x the number Google allowed, so I went with Bing for this one&mldr;</p><p>You can sign up for Bing&rsquo;s Search API on the new <a href=https://datamarket.azure.com/dataset/bing/search>Azure Marketplace</a>, after which you go to <a href=https://datamarket.azure.com/account/keys>your profile</a> in order to get your Access key.</p><p>On my code I set the Access Key as an environment variable called <code>bingAPIkey</code> in order to keep it secret. When running locally use:</p><p><code>bingAPIkey=Your-Key node index.js</code></p><blockquote><p>If you are deploying to Heroku as well remember to setup the Config Variable in the Settings tab.</p></blockquote><p>Serving Bing searches from Nodejs was quite easy after that:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>app</span>) {

	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>bingAPIkey</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>bingAPIkey</span>;

	<span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>bingAPIkey</span>) {
		<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#34;[ERROR] No API key for Bing detected, please set the &#39;bingAPIkey&#39; env variable.&#34;</span>);
		<span style=color:#66d9ef>return</span>;
	}

	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>rootUri</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;https://api.datamarket.azure.com/Bing/Search/v1&#39;</span>,
		<span style=color:#a6e22e>auth</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Buffer</span>([<span style=color:#a6e22e>bingAPIkey</span>, <span style=color:#a6e22e>bingAPIkey</span>].<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;:&#39;</span>)).<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;base64&#39;</span>),
		<span style=color:#a6e22e>request</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;request&#39;</span>).<span style=color:#a6e22e>defaults</span>({
			<span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {
				<span style=color:#e6db74>&#39;Authorization&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Basic &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>auth</span>
			}
		});

	<span style=color:#75715e>// Setup the service
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/search&#39;</span>, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>) {
		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>service_op</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>query</span>.<span style=color:#a6e22e>service_op</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;Web&#39;</span>,
			<span style=color:#a6e22e>query</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>query</span>.<span style=color:#a6e22e>query</span>;

		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>rootUri</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>service_op</span>;

		<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Bing Search: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; -&gt; &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>query</span>);

		<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>get</span>({
			<span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>url</span>,
			<span style=color:#a6e22e>qs</span><span style=color:#f92672>:</span> {
				<span style=color:#a6e22e>$format</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;json&#39;</span>,
				<span style=color:#a6e22e>Query</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#39;&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>query</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;&#39;&#34;</span>, <span style=color:#75715e>// Single quotes required
</span><span style=color:#75715e></span>			}
		}, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>response</span>, <span style=color:#a6e22e>body</span>) {
			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>err</span>) {
				<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>500</span>).<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>message</span>);
			}
			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusCode</span> <span style=color:#f92672>!==</span> <span style=color:#ae81ff>200</span>) {
				<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>500</span>).<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>);
			}

			<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>results</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>);
			<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>results</span>.<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>results</span>);
		});
	});
};
</code></pre></div><h2 id=putting-it-all-together>Putting it all together</h2><p>After all that was working I built a simple UI to display everything, it&rsquo;s still a work in progress so I&rsquo;ll keep adding to this post.</p></div><div class="card related shadow"><div class=card-body><h5 class=card-title>More like this:</h5><div class=item><h6><a href=/post/2020-02-08-procedural-maps/>Procedural Map Generation</a>
<small class="date text-muted">February 8, 2020</small></h6></div><div class=item><h6><a href=/post/2015-03-03-front-end-sample/>Using the latest front-end tech</a>
<small class="date text-muted">March 3, 2015</small></h6></div><div class=item><h6><a href=/post/2014-10-21-making-of-nebula-text/>Making of Nebula text</a>
<small class="date text-muted">October 21, 2014</small></h6></div></div></div></div></div></div></main><footer><p class="copyright text-muted"><a href=/>Alejandro U. Alvarez</a>
© All rights reserved.
&bull;
<a href=/index.xml>RSS</a>
&bull;
<a href=/categories>Categories</a>
&bull;
<a href=/tags>Tags</a></p></footer><div class="border animated-hue"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js></script><script>hljs.initHighlightingOnLoad();</script><script src=https://aurbano.eu/vendor/bootstrap/dist/js/bootstrap.bundle.min.js></script><script>$(document).on('click',function(){$('.collapse').collapse('hide');})</script></body></html>